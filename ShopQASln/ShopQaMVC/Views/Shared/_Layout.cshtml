@using Microsoft.AspNetCore.Identity
@using System.Security.Claims
@{
    var isAuthenticated = User.Identity?.IsAuthenticated == true;
    var userRole = isAuthenticated ? User.FindFirst(ClaimTypes.Role)?.Value : null;
}

<!DOCTYPE html>
<html lang="zxx">
<head>
    <meta charset="UTF-8" />
    <meta name="description" content="Male_Fashion Template" />
    <meta name="keywords" content="Male_Fashion, unica, creative, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Male-Fashion | Template</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap" rel="stylesheet" />

    <!-- Css Styles -->
    <link rel="stylesheet" href="~/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="~/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="~/css/elegant-icons.css" type="text/css" />
    <link rel="stylesheet" href="~/css/magnific-popup.css" type="text/css" />
    <link rel="stylesheet" href="~/css/nice-select.css" type="text/css" />
    <link rel="stylesheet" href="~/css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="~/css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="~/css/style.css" type="text/css" />

    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder"><div class="loader"></div></div>

    <!-- Offcanvas Menu Begin -->
    <div class="offcanvas-menu-overlay"></div>
    <div class="offcanvas-menu-wrapper">
        <div class="offcanvas__option">
            <div class="offcanvas__links" id="offcanvas-auth-links"></div>
            <div class="offcanvas__top__hover" id="offcanvas-auth-settings"></div>
        </div>
        <div class="offcanvas__nav__option">
            <a href="#" class="search-switch"><img src="~/img/icon/search.png" alt="" /></a>
            <a href="#"><img src="~/img/icon/heart.png" alt="" /></a>
            <a href="#"><img src="~/img/icon/cart.png" alt="" /> <span>0</span></a>
            <div class="price"> My Cart</div>
        </div>
        <div id="mobile-menu-wrap"></div>
        <div class="offcanvas__text">
            <p>Free shipping, 30-day return or refund guarantee.</p>
        </div>
    </div>
    <!-- Offcanvas Menu End -->
    <!-- Header Begin -->
    <header class="header">
        <div class="header__top">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-7">
                        <div class="header__top__left">
                            <p>Free shipping, 30-day return or refund guarantee.</p>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-5">
                        <div class="header__top__right d-flex justify-content-end">
                            <div class="header__top__links" id="header-auth-links"></div>
                            <div class="header__top__hover" id="header-auth-settings"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-3">
                    <div class="header__logo">
                        <a href="/Home"><img src="~/img/logo.png" alt="" /></a>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6">
                    <nav class="header__menu mobile-menu">
                        <ul>
                            <li class="active"><a href="/Home">Home</a></li>
                            <li><a href="/Home/Shop">Shop</a></li>
                            <li>
                                <a href="#">Pages</a>
                                <ul class="dropdown">
                                    <li><a href="/Home/NotFoundPage">About Us</a></li>
                                    <li><a href="/Home/NotFoundPage">Shop Details</a></li>
                                    <li><a href="./shopping-cart.html">Shopping Cart</a></li>
                                    <li><a href="/Customer/Checkout">Check Out</a></li>
                                    <li><a href="/Home/NotFoundPage">Blog Details</a></li>
                                </ul>
                            </li>
                            <li><a href="/Home/NotFoundPage">Blog</a></li>
                            <li><a href="/Home/NotFoundPage">Contacts</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="col-lg-3 col-md-3">
                    <div class="header__nav__option">
                        @* <a href="#" class="search-switch"><img src="~/img/icon/search.png" alt="" /></a> *@
                        <a href="/Wishlist/Wishlist"><img src="~/img/icon/heart.png" alt="" /></a>
                        <a href="/Customer/Cart"><img src="~/img/icon/cart.png" alt="" /> <span>0</span></a>
                        <div class="price"> My Cart</div>
                    </div>
                </div>
            </div>
            <div class="canvas__open"><i class="fa fa-bars"></i></div>
        </div>
    </header>
    <!-- Header End -->
    @RenderBody()
    @RenderSection("Scripts", required: false)

    <!-- Footer Begin -->
    <footer class="footer">
        <div class="container">
            <!-- Footer content... giữ nguyên -->
        </div>
    </footer>
    <!-- Footer End -->
    <!-- Search Begin -->
    <div class="search-model">
        <div class="h-100 d-flex align-items-center justify-content-center">
            <div class="search-close-switch">+</div>
            <form class="search-model-form">
                <input type="text" id="search-input" placeholder="Search here....." />
            </form>
        </div>
    </div>
    <!-- Search End -->
    <!-- Js Plugins -->
    <script src="~/js/jquery-3.3.1.min.js"></script>
    <script src="~/js/bootstrap.min.js"></script>
    <script src="~/js/jquery.nice-select.min.js"></script>
    <script src="~/js/jquery.nicescroll.min.js"></script>
    <script src="~/js/jquery.magnific-popup.min.js"></script>
    <script src="~/js/jquery.countdown.min.js"></script>
    <script src="~/js/jquery.slicknav.js"></script>
    <script src="~/js/mixitup.min.js"></script>
    <script src="~/js/owl.carousel.min.js"></script>
    <script src="~/js/main.js"></script>

    <!-- Auth State JS -->
    <script>
        const token = sessionStorage.getItem("JwtToken");
        const user = JSON.parse(sessionStorage.getItem("User") || null);

        const headerAuthLinks = document.getElementById("header-auth-links");
        const headerAuthSettings = document.getElementById("header-auth-settings");

        const offcanvasAuthLinks = document.getElementById("offcanvas-auth-links");
        const offcanvasAuthSettings = document.getElementById("offcanvas-auth-settings");

        function renderAuthUI() {
            if (token && user) {
                const settingsHTML = `
                    <span>Settings <i class="arrow_carrot-down"></i></span>
                    <ul>
                        <li><a href="/Profile/Profile">Profile</a></li>
                        <li><a href="/Customer/Cart">My Cart</a></li>
                        <li><a href="/Order/MyOrders">My Orders</a></li>
                        <li><button onclick="logout()" style="background:none;border:none;padding:0;color:inherit;cursor:pointer;">Sign out</button></li>
                    </ul>
                `;
                headerAuthLinks.innerHTML = `<a href="#">FAQs</a>`;
                headerAuthSettings.innerHTML = settingsHTML;

                offcanvasAuthLinks.innerHTML = `<a href="#">FAQs</a>`;
                offcanvasAuthSettings.innerHTML = settingsHTML;
            } else {
                headerAuthLinks.innerHTML = `<a href="/Account/Login">Sign in</a> <a href="#">FAQs</a>`;
                headerAuthSettings.innerHTML = "";

                offcanvasAuthLinks.innerHTML = `<a href="/Account/Login">Sign in</a> <a href="#">FAQs</a>`;
                offcanvasAuthSettings.innerHTML = "";
            }
        }

        function logout() {
            sessionStorage.clear();
            localStorage.clear();
            document.cookie = "JwtToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
            window.location.href = "/Account/Login";
        }

        renderAuthUI();
    </script>
</body>
</html>
